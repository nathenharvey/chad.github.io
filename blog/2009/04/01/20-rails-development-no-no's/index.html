
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>20 Rails Development No-No's - Chad Fowler</title>
  <meta name="author" content="Chad Fowler">

  
  <meta name="description" content="Yesterday, I asked Twitter:
Rails programmers: what&#8217;s an example of one thing you find in other people&#8217;s Rails
code that you (almost) &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://chadfowler.com/blog/2009/04/01/20-rails-development-no-no%27s/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Chad Fowler" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Chad Fowler</a></h1>
  
    <h2>the passionate programmer, author, speaker, musician, technologist, CTO</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:chadfowler.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/speaking">Speaking</a></li>
  <li><a href="/books">Books</a></li>
  <li><a href="/interviews">Interviews</a></li>
  <li><a href="/contact">Contact</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">20 Rails Development No-No's</h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-04-01T00:00:00-05:00" pubdate data-updated="true">2009.04.01</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Yesterday, <a href="http://twitter.com/chadfowler/statuses/1427732195">I asked Twitter</a>:</p>
Rails programmers: what&#8217;s an example of one thing you find in other people&#8217;s Rails
code that you (almost) always consider to be wrong?
<p>Quite a few people responded, and several asked if I&#8217;d post the aggregated answers. Here&#8217;s an attempt. I don&#8217;t necessarily agree with everything here. I&#8217;d love to hear more of these in the comments.</p>
<h2>1. Code in Views</h2>
<p><a href="http://twitter.com/greg_fu/status/1427754064">@greg_fu</a></p>
<p><a href="http://twitter.com/briandoll/status/1427811202">@briandoll</a></p>
<p><a href="http://twitter.com/mbleigh/status/1427756656">@mbleigh</a></p>
<p>@briandoll&#8217;s response was particularly interesting:</p>
extensive logic in views. If the erb would be ugly and harder to pull off in
haml, it&#8217;s likely a code smell
<p>This is something I always liked in Java about <span class="caps">XMLC</span>:http://www.enhydra.org/tech/xmlc/index.html. It was really hard to end up with a mess of co-mingling code and views, because you would have to work <em>harder</em> in <span class="caps">XMLC</span> to even make that possible.  <a href="http://rubyforge.org/projects/amrita2/">Amrita</a> used to have that same characteristic, but I&#8217;m not sure it still does (or if it is even maintained).</p>
<p>I&#8217;ve been resistant to <a href="http://haml.hamptoncatlin.com/"><span class="caps">HAML</span></a> but maybe it&#8217;s time to give it another look.</p>
<p>Also, as @mbleigh points out, any code in views is suspect. <span class="caps">CSS</span> should be in <span class="caps">CSS</span> files.  Javascript should be in Javascript files.</p>
<h2>2. Tabs instead of spaces and bad indentation</h2>
<p><a href="http://twitter.com/Tricon/status/1427737916">@Tricon</a></p>
<p><a href="http://twitter.com/fowlduck/status/1427790433">@fowlduck</a></p>
<p><a href="http://twitter.com/boboroshi/statuses/1428400137">@boboroshi</a></p>
<p>Enough said.</p>
<h2>3. Bad or Missing Tests</h2>
<p><a href="http://twitter.com/rickbradley/status/1427742106">@rickbradley</a></p>
<p><a href="http://twitter.com/merbist/status/1427755691">@merbist</a></p>
<p><a href="http://twitter.com/alancfrancis/status/1427766801">@alancfrancis</a></p>
<p><a href="http://twitter.com/joshuabates/statuses/1429783137">@joshuabates</a></p>
<p><a href="http://twitter.com/mattsoutherden/statuses/1430399565">@mattsoutherden</a></p>
<p><a href="http://twitter.com/seancribbs/statuses/1432077224">@seancribbs</a></p>
<p><a href="http://twitter.com/seancribbs">@seancribbs</a> singles out auto-generated tests. I&#8217;ll have to agree with him.</p>
<p><a href="http://twitter.com/alancfrancis">@alancfrancis</a> says simply &#8220;rspec&#8221;. Certainly not a religious topic. I&#8217;m sure if you could somehow see in the code which editor someone used, we&#8217;d see a lot of TextMate, vi, and emacs in the responses.</p>
<h2>4. Bad use of Polymorphic Associations and Single-Table Inheritance</h2>
<p><a href="http://twitter.com/brendanbaldwin/status/1427824999">@brendanbaldwin</a> says &#8220;I&#8217;ve seen Polymorphic Associations and Single Table Inheritance abused to absurdity.&#8221;</p>
<p>As have I. I&#8217;ve also abused them to absurdity myself.  The storage of a column called &#8220;type&#8221; which holds a class name is a pretty good indicator that something fishy is going on. It&#8217;s fishy but not always bad. I think, though, that any time you use it you should ask yourself more than once if it&#8217;s the right solution. Databases don&#8217;t do what they do best as well when you have lots of <span class="caps">STI</span> and polymorphic associations.</p>
<h2>5. Cavalier Exception Handling</h2>
<p><a href="http://twitter.com/technomancy/status/1427898481">@technomancy</a></p>
<p><a href="http://twitter.com/mikesax/statuses/1429254463">@mikesax</a></p>
<p>I once had to debug a problem with a commercial, Java-based portal product. The mail module was failing, saying it couldn&#8217;t connect to the mail server. In fact, what was happening was my login credentials were incorrect.  Guess what the offending <span class="caps">JSP</span> looked like (pseudo-code)?</p>
try {
<p>// do everything here<br />
  } catch (Exception e) {<br />
    out.println(&#8220;Unable to connect to the mail server&#8221;)	;<br />
  }</p>
<p>Exceptions are one of the only places in Ruby where you rely on checking the classes of objects to do useful and interesting things. Never rescue Exception unless it&#8217;s at the end of a stanza in which you&#8217;ve already handled one or more other exception types.</p>
<p><span class="caps">UPDATE</span>: from the comments, Phil didn&#8217;t mean what I typed here:</p>
That’s not actually what I meant. Never rescue Exception unless you’re working with code that abuses the
exception hierarchy. In normal circumstances you should be rescuing StandardError instead. If you rescue
Exception, you won’t even be able to ctrl-c your way out of your code(!) among other problems
<p>More info on his weblog <a href="http://technomancy.us/114">here</a></p>
<h2>6. Accidental Local-variable Assignment</h2>
<p><a href="http://twitter.com/technomancy/status/1427898481">@technomancy</a></p>
<pre>
class Potato
attr_accessor :size
end
potato = Potato.new
potato.instance_eval do
size = 123
end
p potato.size
<ol>
	<li>=&gt; nil<br />
</pre></li>
</ol>
<p>Ruby&#8217;s assignment to method-call syntax sugar only works when there&#8217;s an explicit receiver (such as self.size = 123)</p>
<h2>7. Code That Produces Ruby Warnings</h2>
<p><a href="http://twitter.com/tenderlove/statuses/1427958668">@tenderlove</a></p>
<p>Always run with -w. Fix any warnings you see. A good place to see them is when running your application&#8217;s <em>comprehensive</em> test suite.</p>
<h2>8. Code that uses the features of Rails :)</h2>
<p><a href="http://twitter.com/drawohara/statuses/1427969367">@drawohara</a></p>
<p><a href="http://twitter.com/drawohara/statuses/1427990203">@drawohara</a></p>
<p><a href="http://twitter.com/brianleroux/statuses/1427778227">@brianleroux</a></p>
<p><a href="http://twitter.com/joshuabates/statuses/1429783137">@joshuabates</a></p>
<p><span class="caps">RJS</span>, render, nested named routes, and ERb are the targets of these criticisms.</p>
<h2>9. Misuse of validates_uniqueness_of</h2>
<p><a href="http://twitter.com/hedron/statuses/1428222323">@hedron</a></p>
<p>validates_uniqueness_of is a strange critter. It&#8217;s so easy to use, that it&#8217;s tempting to slap it into your code and consider it good enough. But even the documentation for it warns you:</p>
Using this validation method in conjunction with ActiveRecord::Base#save
does not guarantee the absence of duplicate record insertions, because
uniqueness checks on the application level are inherently prone to race
conditions.
<h2>10. Code in the Wrong Place</h2>
<p><a href="http://twitter.com/mperham/statuses/1428346727">@mperham</a></p>
<p><a href="http://twitter.com/bcalloway/statuses/1427760949">@bcalloway</a></p>
<p><a href="http://twitter.com/mikesax/statuses/1429254463">@mikesax</a></p>
<p><a href="http://twitter.com/joshuabates/statuses/1429783137">@joshuabates</a></p>
<p>Here are some rules of thumb:</p>
<ul>
	<li>Nothing that looks at all like <span class="caps">SQL</span> should go into a controller, view, or helper.</li>
	<li>Try to avoid code that causes a database query (even through a shielded <span class="caps">API</span>) in views and helpers</li>
	<li>Never generate <span class="caps">HTML</span> in a model</li>
	<li>Not counting respond_to blocks, shoot for controller actions of 5 lines or less.</li>
</ul>
<h2>11. Configuration Files That Contain Their Own Environment Sections</h2>
<p><a href="http://twitter.com/stonean/statuses/1427754016">@stonean</a></p>
<p>If you create your own configuration file and have to check RAILS_ENV, you&#8217;re not using a built-in facility of Rails.</p>
<h2>12. Too Much Code</h2>
<p><a href="http://twitter.com/aaroncampos/statuses/1427763052">@aaroncampos</a></p>
<p>OK, so this isn&#8217;t really what he meant. But it&#8217;s a good thing to think about. If you find yourself writing a lot of code to do something simple, you might be missing something Rails (or a plugin) provides. I&#8217;ve seen a whole lot of wheels re-invented inside models, controllers, and helpers. Part of Rails mastery is learning to ask yourself, &#8220;Shouldn&#8217;t somebody have already done this for me by now?&#8221;</p>
<h2>13. Messing Up $LOAD_PATH</h2>
<p><a href="http://twitter.com/drnic/statuses/1427781054">@drnic</a></p>
<p>Seems like if you find yourself manipulating Ruby&#8217;s load path in your Rails code, you&#8217;re doing something strange. If you don&#8217;t know you&#8217;re doing something strange, then you&#8217;re probably doing something wrong.</p>
<h2>14. Obfuscated Logic</h2>
<p><a href="http://twitter.com/sneakin/statuses/1427822914">@sneakin</a></p>
<p><a href="http://twitter.com/pelargir/statuses/1429096093">@pelargir</a></p>
<p>As <a href="http://pragprog.com">Dave Thomas</a> likes to say &#8220;Don&#8217;t not use positive logic&#8221; (or something like that).</p>
<p>Can someone tell me <em>where</em> the use of &#8220;!!true&#8221; crept into the Ruby vernacular? Sure, it&#8217;s syntactically valid to do:</p>
<pre>
<p>!!!!!!!!!!!!!!!!!!ok?<br />
  </pre></p>
<p>But why?</p>
<p>It&#8217;s April 1st, so my mind wanders to the hypothesis that someone introduced this and started spreading it as an elaborate joke. If so, well played. Is there a good use of this idiom I&#8217;m missing?</p>
<h2>15. Seed Data in Migrations</h2>
<p><a href="http://twitter.com/lifo/statuses/1428634121">@lifo</a></p>
<p>ActiveRecord migrations define a simple <span class="caps">API</span>/<span class="caps">DSL</span> for doing schema manipulation. But when they run, they&#8217;re just Ruby classes and methods executing within the Rails environment. So you can do anything you like in that context.</p>
<p>Sometimes people use migrations to load seed data. Pratik doesn&#8217;t like this.</p>
<p>I&#8217;m on the fence on this one. In small doses it doesn&#8217;t strike me as a horrible practice. That being said, I don&#8217;t tend to do it. I&#8217;d be interested in hearing opinions.</p>
<h2>16.  Sending Data on <span class="caps">GET</span> Requests</h2>
<p><a href="http://twitter.com/Adkron/statuses/1428640575">@Adkron</a></p>
<p>I guess it depends on what you&#8217;re doing with the parameters. Sometimes long parameter lists on <span class="caps">GET</span> requests are a sign that there are two actions&#8217; worth of work happening in a single action. Or that you&#8217;re doing something that belongs behind a <span class="caps">POST</span> or <span class="caps">PUT</span>. This one doesn&#8217;t bother me as much as it does <a href="http://twitter.com/Adkron">@Adkron</a>.</p>
<h2>17. Not Using Transactions</h2>
<p><a href="http://twitter.com/sbfaulkner/statuses/1428534172">@sbfaulkner</a></p>
<pre>
<p>if foo.save &amp;&amp; bar.save<br />
  </pre></p>
<p>if bar fails to save, foo doesn&#8217;t.  Oops. I&#8217;ve seen this more than once in the wild.</p>
<h2>18. Bad Use of Javascript</h2>
<p><a href="http://twitter.com/leandroico/statuses/1428498212">@leandroico</a></p>
<p><a href="http://twitter.com/RobotDeathSquad/statuses/1428400742">@RobotDeathSquad</a></p>
<p>Obtrusive Javascript and <span class="caps">RJS</span> are the themes here.</p>
<p>What&#8217;s the worst use of <span class="caps">RJS</span> you&#8217;ve seen? I love <span class="caps">RJS</span>. I may be one of the offenders. Doesn&#8217;t feel like it (usually) though.</p>
<h2>19. Long Methods</h2>
<p><a href="http://twitter.com/mikesax/statuses/1429228639">@mikesax</a></p>
<p>Smalltalk people, as a collective culture, seem to get this right. <a href="http://www.threeriversinstitute.org/">Kent Beck</a> documents a simple pattern in his <a href="http://www.amazon.com/Smalltalk-Best-Practice-Patterns-Kent/dp/013476904X">Smalltalk Best Practice Patterns</a> called &#8220;Compose Method&#8221;. He says that one way to determine whether a new method is required is whether all of the code in a given method operates at the same level of abstraction. That&#8217;s a simple but <em>powerful</em> rule. Think about it next time you&#8217;re coding and I think you&#8217;ll agree.</p>
<h2>20. Chatty Comments</h2>
<p><a href="http://twitter.com/mikesax/statuses/1429239355">@mikesax</a></p>
<p>I agree with Mike on this one. I don&#8217;t tend to write any comments, so I may be on the anti-comment side to a fault. My goal is always to write code that is clear enough that comments don&#8217;t add anything. If you name everything well and keep your classes, modules, and methods short, you&#8217;re already going to make comments redundant in a lot of cases.</p>
<p>Whenever I see a comment <em>inside</em> a method definition, I consider it a bad sign. In most cases, whenever you encounter a comment inside a method, it&#8217;s a marker for where code should be extracted into a new method.</p>
<p>If you&#8217;re writing a framework, the rules are different. But most of the time as a Rails developer, you shouldn&#8217;t be writing a framework.</p></div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Chad Fowler</span></span>

      








  


<time datetime="2009-04-01T00:00:00-05:00" pubdate data-updated="true">2009.04.01</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://chadfowler.com/blog/2009/04/01/20-rails-development-no-no%27s/" data-via="chadfowler" data-counturl="http://chadfowler.com/blog/2009/04/01/20-rails-development-no-no%27s/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2009/03/19/railsconf-speaker-interview-michael-bleigh/" title="Previous Post: RailsConf Speaker Interview: Michael Bleigh">&laquo; RailsConf Speaker Interview: Michael Bleigh</a>
      
      
        <a class="basic-alignment right" href="/blog/2009/04/02/railsconf-speaker-interview-neal-ford-and-paul-gross/" title="Next Post: RailsConf Speaker Interview: Neal Ford and Paul Gross">RailsConf Speaker Interview: Neal Ford and Paul Gross &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <ol id="social-media-links">
  <li class="github"><a href="https://github.com/chad?rel=author">Github</a></li>
  <li class="twitter"><a href="https://twitter.com/chadfowler?rel=author">Twitter</a></li>
  <li class="google-plus"><a href="https://plus.google.com/115940317748827567617?rel=author">Google Plus</a></li>
  <li class="rss"><a href="http://feeds.feedburner.com/ThePassionateProgrammer">RSS</a></li>
</ol>
<section id="upcoming-speaking" class="widget">
  <h2 class="widget-header">See Me Speak</h2>
  <ol>
      <li class="vevent">
        <span class="summary"><a href="http://www.nordicruby.org/">Nordic Ruby</a></span>
        <span class="location">Stockholm</span>
        <span class="the-date">June 6-9, 2013</span>
      </li>
      <li class="vevent">
        <span class="summary"><a href="http://gotocon.com/berlin-2013/upcomingevents/">GOTO Night</a></span>
        <span class="location">Berlin</span>
        <span class="the-date">June 17, 2013</span>
      </li>
      <li class="vevent">
        <span class="summary"><a href="http://gotocon.com/aarhus-2013/">GOTO</a></span>
        <span class="location">Aarhus</span>
        <span class="the-date">September 30, 2013</span>
      </li>
      <li class="vevent">
        <span class="summary"><a href="http://railsisrael.events.co.il">Rails Israel</a></span>
        <span class="location">Tel Aviv</span>
        <span class="the-date">October 9, 2013</span>
      </li>
  </ol>

  <!--<a class="more-events" href="#">More Events »</a>-->
  <p class="i-speak">Want me to speak at your event? <a href="mailto:chad@chadfowler.com">Email me.</a></p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/07/16/passionate-programmer-a-free-excerpt-almost-every-week/">Passionate Programmer - A free chapter (almost) every week until it's done</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/23/immutable-deployments/">Trash Your Servers and Burn Your Code: Immutable Infrastructure and Disposable Components</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/08/how-to-give-a-keynote/">How to Give a Keynote</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/25/how-to-get-your-conference-talk-accepted/">How to get your conference talk accepted</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/20/discipline-stomp-out-cynicism/">Discipline: Stomp Out Cynicism</a>
      </li>
    
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Chad Fowler -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
